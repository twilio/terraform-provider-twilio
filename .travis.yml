language: go
go:
- '1.15'
- '1.16'
env:
- TF_INPUT=false TF_VERSION=1.0.0
before_install:
- wget https://releases.hashicorp.com/terraform/"$TF_VERSION"/terraform_"$TF_VERSION"_linux_amd64.zip
- unzip terraform_"$TF_VERSION"_linux_amd64.zip
- sudo mv terraform /usr/local/bin/
- rm terraform_"$TF_VERSION"_linux_amd64.zip
install:
- make install test
jobs:
  include:
  - language: go
    go: '1.16'
    after_success:
    - sonar-scanner
script:
- echo "$TRAVIS_BRANCH"
- echo $TRAVIS_PULL_REQUEST
- if [[ "$TRAVIS_BRANCH" == "main"  ||  "$TRAVIS_BRANCH" == "travis" ]] && [ "$TRAVIS_PULL_REQUEST"
  == "false" ]; then make testacc TWILIO_ACCOUNT_SID="$ACCOUNT_SID" TWILIO_AUTH_TOKEN="$AUTH_TOKEN";
  fi
- make cover
notifications:
  slack:
    if: branch = main
    on_pull_requests: false
    on_success: never
    on_failure: change
    rooms:
      secure: u5V05tOR3IkkwYIGrX0l9rvLdc6h1RiHlgzrMTkcJ7CKAvMRE50KVv/kkzJ+CRlKnmJCmmy2/NRw4JbmbubGyZ2/kp3oqmkPRqbHNKlZqQlmW0OacexDxnKxJwhV5uGVAO2ErDKHCoE3O13jsVUiiPmJqpWl5qOU/Gh9K7/YvO0zKAj+fms2hJSG+tw1Qkz+DrMflvSV7MuZLelOWVLI/Jg584wlymN+Tp8Y6N2Napv40XSDz8vneo+vtoay+9tdmRNEwLeNihPWjKQQO+mYiWwtyNm7TcK9nu+IRDt+/B/wAV6Jgnw/6o7+pPsXwGMvR0SIYtgkGz3olgkxIDrPWx7F0Bm+uEwI4JMNYgnR69QXUpmwd1cfSxHpu3tHYWtGExMht8NRCs51UAW9W8qz+x8mHH9p4q+Mq0a4pN3Q82Qj8B+KQCHWX6ZlrO0cWV748cXcVlVh25QVUHfZHfBqKyMQ/QeLTufsROROqYNyXbdUiMziWzSGddo/hscOPWyCYIka+k/B9pzUwi6RoXrlYsfoVRAYCLk+AtXt2xsFqUCkajozZx92Wes1mxrakLLBPQt4r8zjPMMg+nH0DXWi13tD3SMfIPaog543J2CRifQN9CTATdMGK7BCM5kqw2U9u0ZXX5zg6IMebukDxfoHxCtYwEqpJX0OXFTWzzsXnJw=
addons:
  sonarcloud:
    organization: twilio
    token:
      secure: t7m+9OALjD/Ik0ZFAF3xRK2LxOEtaFV4Q+2OKAHrezVQDAueYz/mHom2OuSnxwXE6eDbTLuf5ey003jSF0uMFxftiA/APJdtueN+gTs6+PZT7MEQMeavSmF9sKU3VcZ1xczoArJocV/r0lPorpgr17jjheW8+yLEkciOF9jGM1rGS3YrxlSSsZwfM9vH10pBTfXC0x3z6v39RY/Ge+tSQtouIvirAdo5yEnCtRovdTbTVtfyqerJgkOaxo5VW5GqBexibQ1wk8sAb7VxzP8qJIlYfFllGWawWcyYkivd7TodWhmIghwUvCWTgdwoWfQVbiywnOSljj3AZgeRhH8OgG4pwRakuQaJvPzXE/uEWVoIcy9NnAowdL1w1Xs+i7vvUrDeK6pRHjbNWNSpQX50jgaU0AQ6ffOyORd0o20XJ8+cIzEqtx/TPxv+XfREHpdKKdpsELWBxDRhTMrzrlajNu6LCfQos2548qVa7bPauv1o+qJRQsLlloeA6a97UU4rMni6VKRsSAZid2kg+BVZG216qdD8Gatz7PlslgqRSwKyp+oMc0AZcWpGp5df3x8ERfZ4GucO8vzj8dw6bNmUWsh4aMfSQrc86jStAUYgfghbhAbD73G2RJSlyVqGLRWpq5CmI/PBJpVWp2VnMii3NX8Yt+gQO4Dk7N5o0FO9+cM=
